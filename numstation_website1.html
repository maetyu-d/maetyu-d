<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>[Your Name] — Signals & Isotopes</title>
  <meta name="description" content="Personal site themed around numbers stations and nuclear physics: projects, writing, and interactive lab." />
  <meta name="theme-color" content="#111" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='black'/%3E%3Ctext x='50' y='70' text-anchor='middle' font-size='70' fill='%23ffd400' font-family='monospace'%3E%E2%98%A2%3C/text%3E%3C/svg%3E"/>
  <style>
    :root{
      --bg:#0b0c0d;          /* bunker black */
      --bg-soft:#0f1113;
      --fg:#e6e6e6;          /* paper grey */
      --muted:#9aa0a6;       /* utility grey */
      --accent:#ffd400;      /* hazard yellow */
      --accent-2:#8fbf6a;    /* radiation green */
      --danger:#d43d3d;      /* warning red */
      --grid:rgba(255,255,255,.04);
      --card:#0f1113;
      --radius:4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth}
    body{
      margin:0; font: 14px/1.5 ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      color:var(--fg); background:var(--bg);
      overflow-x:hidden;
      background-image:
        repeating-linear-gradient(0deg, var(--grid) 0 1px, transparent 1px 3px),
        linear-gradient(180deg, rgba(255,255,255,.02), transparent 40%);
      image-rendering:pixelated;
    }
    .bg-static{position:fixed; inset:0; pointer-events:none; z-index:-2;}
    .bg-static::before{content:""; position:absolute; inset:-10%;
      background:
        repeating-linear-gradient(90deg, rgba(255,255,255,.03) 0 1px, transparent 1px 4px),
        repeating-linear-gradient(0deg, rgba(255,255,255,.02) 0 2px, transparent 2px 6px);
      filter:contrast(100%);
    }
    .bg-noise{position:fixed; inset:0; opacity:.04; mix-blend-mode:screen; z-index:-1}

    header{position:sticky; top:0; z-index:50;
      background:var(--bg);
      border-bottom:1px solid #2b2f33;
    }
    .wrap{max-width:1100px; margin:0 auto; padding:0 20px}
    nav{display:flex; align-items:center; gap:12px; padding:10px 0}
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.12em; text-transform:uppercase}
    .brand .dot{width:10px;height:10px; background:var(--accent)}
    .spacer{flex:1}
    .navlink{color:var(--muted); text-decoration:none; padding:4px 8px; border-radius:2px; border:1px solid transparent}
    .navlink:hover{color:var(--fg); border-color:#3a3f45; background:#0e1114}
    .cta{padding:8px 12px; border-radius:2px; color:#111; background:transparent; text-decoration:none; font-weight:800; text-transform:uppercase; border:1.5px solid var(--accent)}
    .cta:hover{background:var(--accent)}

    .hero{position:relative; padding:80px 0 50px; border-bottom:1px solid #2b2f33}
    .grid{display:grid; grid-template-columns: 1.2fr .8fr; gap:20px}
    .callout{background:var(--card); border:1px solid #2b2f33; padding:18px; border-radius:var(--radius)}
    h1{font-size:32px; line-height:1.15; margin:0 0 8px; letter-spacing:.12em; text-transform:uppercase}
    .subtitle{color:var(--muted); margin:0 0 12px}
    .ticker{display:grid; grid-template-columns:repeat(5,1fr); gap:8px; font-size:22px; letter-spacing:.2em}
    .tick{background:#0b0d10; border:1px solid #2b2f33; border-radius:2px; padding:12px; text-align:center}

    .cards{display:grid; grid-template-columns: repeat( auto-fit, minmax(260px, 1fr) ); gap:14px}
    .card{background:var(--card); border:1px solid #2b2f33; padding:16px; border-radius:var(--radius)}
    .card h3{margin:.2rem 0 .4rem; font-size:16px; text-transform:uppercase; letter-spacing:.08em}
    .kicker{color:var(--accent); text-transform:uppercase; letter-spacing:.18em; font-size:11px}

    section{padding:50px 0}
    section h2{font-size:18px; letter-spacing:.2em; text-transform:uppercase; color:var(--accent); margin:0 0 10px}
    p{margin:.55rem 0}
    .muted{color:var(--muted)}

    .lab-grid{display:grid; grid-template-columns:repeat( auto-fit, minmax(300px, 1fr) ); gap:16px}
    canvas.plot{width:100%; height:220px; background:#0b0d10; border:1px solid #2b2f33; border-radius:2px}
    .controls{display:flex; align-items:center; gap:10px; flex-wrap:wrap; margin-top:10px}
    .controls label{font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:.1em}
    input[type="range"]{width:160px}
    button{appearance:none; border:1px solid #3a3f45; border-radius:2px; background:#0e1114; color:var(--fg); padding:8px 10px; cursor:pointer}
    button:hover{border-color:var(--accent)}

    .kbd{display:inline-block; border:1px solid #3a3f45; padding:.1em .5em; border-radius:2px; background:#0c1013;}

    footer{padding:40px 0; border-top:1px solid #2b2f33; color:var(--muted)}

    /* Blog/Markdown */
    .post-list{display:grid; grid-template-columns: repeat( auto-fit, minmax(260px,1fr) ); gap:14px}
    .post-item{border:1px solid #2b2f33; padding:14px; border-radius:4px; background:#0f1113}
    .post-item a{color:var(--fg); text-decoration:none}
    .post-item a:hover{text-decoration:underline}

    .md{line-height:1.6}
    .md h1,.md h2,.md h3,.md h4{margin:1.2em 0 .4em; text-transform:uppercase; letter-spacing:.08em}
    .md p{margin:.8em 0}
    .md pre{overflow:auto; padding:10px; border:1px solid #2b2f33; background:#0b0d10; border-radius:4px}
    .md code{background:#0b0d10; padding:.1em .3em; border:1px solid #2b2f33; border-radius:3px}
    .md blockquote{margin:1em 0; padding:0 1em; border-left:3px solid var(--accent); color:var(--muted)}
    .md ul,.md ol{padding-left:1.4em}
    .md hr{border:0; border-top:1px dashed #3a3f45; margin:1.5em 0}

    @media(max-width:900px){
      .grid{grid-template-columns:1fr}
      .hero{padding-top:60px}
    }
    @media (prefers-reduced-motion: reduce) {
      *{animation:none !important; transition:none !important}
    }
  </style>
</head>
<body>
  <canvas class="bg-noise" id="noise"></canvas>
  <div class="bg-static"></div>

  <header>
    <div class="wrap">
      <nav>
        <div class="brand"><span class="dot" aria-hidden="true"></span><span id="callsign">E07 // [YOUR CALLSIGN]</span></div>
        <a class="navlink" href="#home">Home</a>
        <a class="navlink" href="#about">About</a>
        <a class="navlink" href="#lab">Lab</a>
        <a class="navlink" href="#blog">Blog</a>
        <a class="navlink" href="#log">Log</a>
        <a class="navlink" href="#contact">Contact</a>
        <div class="spacer"></div>
        <time id="utc" class="navlink" aria-live="polite" title="UTC clock"></time>
        <button id="noiseToggle" aria-pressed="false" title="Toggle radio/Geiger noise" style="margin-left:8px">Noise ▷</button>
      </nav>
    </div>
  </header>

  <main>
    <section id="home" class="hero">
      <div class="wrap grid">
        <div class="callout">
          <h1>[Your Name]</h1>
          <p class="subtitle">Signals, code, and particles. A personal site inspired by clandestine numbers stations and the mathematics of radioactive decay.</p>
          <div class="ticker" aria-label="numbers station groups" id="ticker" role="log" aria-live="polite"></div>
          <div class="controls" style="margin-top:12px">
            <a class="cta" href="#contact">Get in touch</a>
            <a class="navlink" href="#lab">Explore the Lab →</a>
          </div>
        </div>
        <div class="cards">
          <div class="card">
            <div class="kicker">Signal</div>
            <h3>Station Protocol</h3>
            <p class="muted">Broadcasts are five-digit groups. Authentication via opening/closing phrases. Always UTC. Trust no carrier.</p>
          </div>
          <div class="card">
            <div class="kicker">Physics</div>
            <h3>Half-life & Decay</h3>
            <p class="muted">Exponential processes, Poisson arrivals, and chains: α, β±, γ. Models guide the art—and the clicks.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="about">
      <div class="wrap">
        <h2>About</h2>
        <div class="cards">
          <div class="card">
            <h3>Who</h3>
            <p>I'm <strong>[Your Name]</strong>, a creator working across code, audio, and physics-flavoured art. I like projects that feel like intercepting a transmission at 3 AM.</p>
            <p>Focus areas: experimental interfaces, game audio, browser instruments, and scientifically-inspired visuals.</p>
          </div>
          <div class="card">
            <h3>What</h3>
            <ul>
              <li>Interactive systems with minimal dependencies.</li>
              <li>Accessible, reduced-motion friendly design.</li>
              <li>Art that nods to <span class="kbd">S-numbers</span>, one-time pads, and isotopes.</li>
            </ul>
          </div>
          <div class="card">
            <h3>Elsewhere</h3>
            <p><a class="navlink" href="#" id="linkGithub">GitHub</a> · <a class="navlink" href="#" id="linkMastodon">Mastodon</a> · <a class="navlink" href="#" id="linkSubstack">Newsletter</a></p>
            <p class="muted">Add your own links in the <span class="kbd">CONFIG</span> at the top of the script.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="lab">
      <div class="wrap">
        <h2>Interactive Lab</h2>
        <div class="lab-grid">
          <div class="card">
            <div class="kicker">Decay</div>
            <h3>Half-Life Visualizer</h3>
            <canvas class="plot" id="decayPlot" width="640" height="300" aria-label="exponential decay plot" role="img"></canvas>
            <div class="controls">
              <label>Half-lives span
                <input type="range" id="spanHL" min="2" max="10" step="1" value="6" /> <span id="spanHLVal">6</span>
              </label>
              <label>Initial N₀
                <input type="range" id="n0" min="100" max="2000" step="100" value="1000" /> <span id="n0Val">1000</span>
              </label>
              <button id="simulateBtn">Simulate</button>
              <button id="resetBtn">Reset</button>
            </div>
            <p class="muted">Shows <em>N(t)=N₀·2^(−t/T½)</em> over a chosen number of half-lives, plus a discrete simulation (faint) of decays.</p>
          </div>

          <div class="card">
            <div class="kicker">Poisson</div>
            <h3>Geiger-like Clicks</h3>
            <p>Rate <span id="rateOut">15</span> cps</p>
            <input type="range" id="rate" min="1" max="60" value="15" />
            <div class="controls">
              <button id="geigerStart">Start</button>
              <button id="geigerStop">Stop</button>
            </div>
            <p class="muted">Inter-arrival times are exponential; average rate set above. Uses Web Audio for short impulses.</p>
          </div>

          <div class="card">
            <div class="kicker">Cipher</div>
            <h3>Five-Digit Groups</h3>
            <label for="padSeed">Pad seed</label>
            <input id="padSeed" value="E07" aria-label="pad seed" />
            <label for="plain">Message</label>
            <textarea id="plain" rows="3" placeholder="TYPE ONLY A–Z AND SPACES"></textarea>
            <div class="controls">
              <button id="encode">Encode</button>
              <button id="decode">Decode</button>
              <button id="copyGroups">Copy</button>
            </div>
            <pre id="groups" style="white-space:pre-wrap; user-select:text"></pre>
            <p class="muted">Toy one-time pad demo (base-27 letters). Not secure—just vibes.</p>
          </div>

          <div class="card">
            <div class="kicker">Isotopes</div>
            <h3>Quick Reference</h3>
            <div id="isotopes"></div>
            <p class="muted">Sample isotopes with T½ and decay mode. Edit the list in <span class="kbd">CONFIG</span>.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="blog">
      <div class="wrap">
        <h2>Blog</h2>
        <div class="cards">
          <div class="card" style="grid-column:1/-1">
            <div class="kicker">Local Markdown</div>
            <p class="muted">Place <span class="kbd">.md</span> files in <span class="kbd">/posts</span>. Listed below via <em>BLOG.index</em>.</p>
          </div>
        </div>
        <div class="post-list" id="blogList"></div>
        <article class="card md" id="blogArticle" style="margin-top:16px; display:none"></article>
      </div>
    </section>

    <section id="log">
      <div class="wrap">
        <h2>Transmission Log</h2>
        <div class="cards" id="posts"></div>
      </div>
    </section>

    <section id="contact">
      <div class="wrap">
        <h2>Contact</h2>
        <div class="cards">
          <div class="card">
            <h3>Send a signal</h3>
            <p>Email: <a id="emailLink" href="mailto:you@example.com">you@example.com</a></p>
            <div class="controls">
              <button id="copyEmail">Copy email</button>
              <button id="openMail">Open mail app</button>
            </div>
            <p class="muted">Optional: publish a PGP key here.</p>
          </div>
          <div class="card">
            <h3>Colophon</h3>
            <p>This site is a single HTML file: no frameworks, no trackers, just signals. Dark-mode by design; respects <em>reduced motion</em>.</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="wrap">
      <small>© <span id="year"></span> [Your Name]. Built with love for shortwave and the Standard Model.</small>
    </div>
  </footer>

  <script>
  /* =====================
     CONFIG — edit me!
  ===================== */
  const CONFIG = {
    name: "[Your Name]",
    callsign: "E07",
    email: "you@example.com",
    links: {
      github: "https://github.com/yourname",
      mastodon: "https://mastodon.social/@yourname",
      substack: "https://substack.com/@yourname"
    },
    posts: [
      { title: "Intercept: building a browser Geiger", date: "2025-05-14", url: "#", excerpt: "Simulating Poisson arrivals and envelope clicks with Web Audio." },
      { title: "Half-life as design pattern", date: "2025-03-02", url: "#", excerpt: "Decay curves as pacing for interactive work." },
      { title: "Tuning to ghosts", date: "2024-11-01", url: "#", excerpt: "Numbers stations, verification phrases, and nostalgia." }
    ],
    isotopes: [
      { nuclide: "Cs-137", halfLife: "30.17 y", mode: "β− → Ba-137m + γ" },
      { nuclide: "U-238", halfLife: "4.468×10⁹ y", mode: "α → Th-234" },
      { nuclide: "Co-60", halfLife: "5.27 y", mode: "β− + γ" },
      { nuclide: "Po-210", halfLife: "138.376 d", mode: "α → Pb-206" }
    ]
  };

  /* =====================
     UTILITIES
  ===================== */
  const $ = s => document.querySelector(s);
  const $$ = s => [...document.querySelectorAll(s)];

  function updateUTC(){
    const d = new Date();
    const p = n => String(n).padStart(2,'0');
    const ts = `${d.getUTCFullYear()}-${p(d.getUTCMonth()+1)}-${p(d.getUTCDate())} ${p(d.getUTCHours())}:${p(d.getUTCMinutes())}:${p(d.getUTCSeconds())} UTC`;
    $('#utc').textContent = ts;
  }

  function drawNoise(){
    const c = $('#noise');
    const ctx = c.getContext('2d', {alpha:true});
    const dpr = Math.min(2, window.devicePixelRatio || 1);
    c.width = innerWidth * dpr; c.height = innerHeight * dpr; c.style.width = '100%'; c.style.height = '100%';
    const img = ctx.createImageData(c.width, c.height);
    for(let i=0;i<img.data.length;i+=4){
      const v = Math.random()*255|0;
      img.data[i]=img.data[i+1]=img.data[i+2]=v; img.data[i+3]=255;
    }
    ctx.putImageData(img,0,0);
  }

  function startTicker(){
    const t = $('#ticker');
    function group(){ let s=""; for(let i=0;i<5;i++) s += Math.random()*10|0; return s; }
    for(let i=0;i<15;i++){ const d = document.createElement('div'); d.className='tick'; d.textContent = group(); t.appendChild(d); }
    setInterval(()=>{ const cells = $$('.tick'); const idx = Math.random()*cells.length|0; cells[idx].textContent = group(); }, 180);
  }

  function renderPosts(){
    const box = $('#posts');
    CONFIG.posts.forEach(p=>{
      const card = document.createElement('article'); card.className='card';
      card.innerHTML = `<div class="kicker">${p.date}</div><h3><a class="navlink" href="${p.url}">${p.title}</a></h3><p class="muted">${p.excerpt}</p>`;
      box.appendChild(card);
    });
  }

  function renderIsotopes(){
    const box = $('#isotopes');
    box.innerHTML = CONFIG.isotopes.map(i=>`
      <div style="display:flex; justify-content:space-between; gap:8px; padding:8px 10px; margin:6px 0; border:1px solid #2b2f33; border-radius:2px; background:#0b0d10">
        <strong style="color:var(--accent-2)">${i.nuclide}</strong>
        <span class="muted">T½ ${i.halfLife}</span>
        <span>${i.mode}</span>
      </div>`).join('');
  }

  function decayPlot(){
    const c = $('#decayPlot'); const ctx = c.getContext('2d');
    const w = c.width, h = c.height; ctx.clearRect(0,0,w,h);
    ctx.strokeStyle = 'rgba(255,255,255,0.25)'; ctx.lineWidth=1; ctx.beginPath(); ctx.moveTo(40,10); ctx.lineTo(40,h-30); ctx.lineTo(w-10,h-30); ctx.stroke();
    const spans = +$('#spanHL').value; const N0 = +$('#n0').value; $('#spanHLVal').textContent = spans; $('#n0Val').textContent = N0;
    const T = 1; const tMax = spans * T; const left=40, bottom=h-30, right=w-10, top=10; const pw = right-left, ph = bottom-top;
    ctx.strokeStyle='#2b2f33'; ctx.beginPath(); for(let i=1;i<=spans;i++){ const x = left + pw*(i/spans); ctx.moveTo(x,top); ctx.lineTo(x,bottom);} ctx.stroke();
    ctx.strokeStyle = 'rgba(255,212,0,0.9)'; ctx.lineWidth=2; ctx.beginPath();
    for(let px=0; px<=pw; px++){
      const t = tMax * (px/pw);
      const N = N0 * Math.pow(0.5, t/T);
      const y = bottom - ph*(N/N0);
      if(px===0) ctx.moveTo(left, y); else ctx.lineTo(left+px, y);
    }
    ctx.stroke();
    if(window._sim && window._sim.length){
      ctx.fillStyle='rgba(143,191,106,.6)';
      const maxT = Math.max(...window._sim.map(s=>s.t));
      window._sim.forEach(s=>{ const x = left + pw*(s.t/maxT); const y = bottom - ph*(s.n/N0); ctx.fillRect(x, y, 2, 2); });
    }
    ctx.fillStyle='rgba(255,255,255,.7)'; ctx.font='12px ui-monospace, monospace';
    ctx.fillText('time (half-lives)', w-150, h-10);
    ctx.save(); ctx.translate(14, h/2); ctx.rotate(-Math.PI/2); ctx.fillText('N(t)/N₀', 0,0); ctx.restore();
  }

  function simulateDiscrete(){
    const spans = +$('#spanHL').value; const N0 = +$('#n0').value;
    const lambda = Math.log(2);
    const dt = 0.02; const steps = Math.floor(spans/dt);
    let n = N0; const out = []; let t=0;
    for(let i=0;i<=steps;i++){
      const p = 1-Math.exp(-lambda*dt);
      const decays = Math.min(n, poisson(n*p));
      n -= decays; t = i*dt; out.push({t, n}); if(n<=0) break;
    }
    window._sim = out; decayPlot();
  }

  function poisson(mean){
    const L = Math.exp(-mean); let k=0, p=1; do{ k++; p *= Math.random(); } while(p>L); return k-1;
  }

  let geiger = { ctx:null, on:false, next:0, rate:15 };
  function setupAudio(){ if(!geiger.ctx){ geiger.ctx = new (window.AudioContext||window.webkitAudioContext)(); } }
  function scheduleGeiger(){
    if(!geiger.on) return;
    const now = geiger.ctx.currentTime;
    while(geiger.next < now + 0.1){
      const u = Math.random();
      const interval = -Math.log(1-u) / geiger.rate;
      geiger.next = (geiger.next||now) + interval;
      clickAt(geiger.next);
    }
    requestAnimationFrame(scheduleGeiger);
  }
  function clickAt(t){
    const o = geiger.ctx.createOscillator(); const g = geiger.ctx.createGain();
    o.type='square'; o.frequency.setValueAtTime(1000, t);
    g.gain.setValueAtTime(0.001, t);
    g.gain.exponentialRampToValueAtTime(0.1, t+0.002);
    g.gain.exponentialRampToValueAtTime(0.0001, t+0.02);
    o.connect(g).connect(geiger.ctx.destination); o.start(t); o.stop(t+0.03);
  }

  let noiseOn = false, noiseNode=null;
  function toggleNoise(){
    setupAudio();
    if(!noiseOn){
      const bufferSize = 2 * geiger.ctx.sampleRate; const buffer = geiger.ctx.createBuffer(1, bufferSize, geiger.ctx.sampleRate);
      const data = buffer.getChannelData(0);
      for (let i=0;i<bufferSize;i++){ data[i] = (Math.random()*2-1)*0.15; }
      const src = geiger.ctx.createBufferSource(); src.buffer = buffer; src.loop=true;
      const filt = geiger.ctx.createBiquadFilter(); filt.type='bandpass'; filt.frequency.value=4000; filt.Q.value=0.7;
      src.connect(filt).connect(geiger.ctx.destination); src.start(); noiseNode = src; noiseOn = true; $('#noiseToggle').textContent='Noise ❚❚'; $('#noiseToggle').setAttribute('aria-pressed','true');
    } else {
      if(noiseNode){ try{ noiseNode.stop(); }catch(e){} noiseNode.disconnect(); noiseNode=null; }
      noiseOn=false; $('#noiseToggle').textContent='Noise ▷'; $('#noiseToggle').setAttribute('aria-pressed','false');
    }
  }

  function seedPRNG(seed){
    let h = 2166136261;
    for(let i=0;i<seed.length;i++){ h ^= seed.charCodeAt(i); h = Math.imul(h, 16777619); }
    let x = (h>>>0) || 123456789;
    return function(){ x ^= x<<13; x ^= x>>>17; x ^= x<<5; x >>>=0; return x % 10; }
  }
  function toBase27(text){
    const A='ABCDEFGHIJKLMNOPQRSTUVWXYZ '; const map = new Map([...A].map((c,i)=>[c,i]));
    const clean = [...text.toUpperCase()].filter(c=>map.has(c));
    const nums = clean.map(c=>map.get(c));
    const digits=[]; for(const n of nums){ const t = String(n).padStart(2,'0'); digits.push(+t[0], +t[1]); }
    return digits;
  }
  function fromBase27(digits){
    const A='ABCDEFGHIJKLMNOPQRSTUVWXYZ '; const out=[];
    for(let i=0;i<digits.length;i+=2){ const n = digits[i]*10 + (digits[i+1]||0); if(n>=0 && n<=26) out.push(A[n]); }
    return out.join('');
  }
  function chunk5(digs){ const out=[]; for(let i=0;i<digs.length; i+=5){ out.push(digs.slice(i,i+5).join('')); } return out.join(' '); }
  function unchunk5(s){ return s.replace(/\D+/g,'').split('').map(d=>+d); }

  function encodeMsg(){
    const seed = $('#padSeed').value || 'E07'; const prng = seedPRNG(seed);
    const digits = toBase27($('#plain').value);
    const enc = digits.map(d=> (d + prng()) % 10);
    $('#groups').textContent = chunk5(enc);
  }
  function decodeMsg(){
    const seed = $('#padSeed').value || 'E07'; const prng = seedPRNG(seed);
    const enc = unchunk5($('#groups').textContent);
    const dec = enc.map(d=> (10 + d - prng()) % 10);
    $('#plain').value = fromBase27(dec);
  }

  function copyText(el){
    const txt = typeof el==='string'? el : el.textContent;
    navigator.clipboard.writeText(txt).then(()=>{
      const b = $('#copyGroups'); if(b){ b.textContent='Copied ✓'; setTimeout(()=>b.textContent='Copy', 1000); }
    });
  }

  /* =====================
     BLOG — local Markdown loader
  ===================== */
  const BLOG = {
    dir: "posts",
    index: [
      { file: "2025-08-01-half-life-as-metaphor.md", title: "Half-life as Metaphor", date: "2025-08-01" },
      { file: "2025-07-17-numbers-station-research.md", title: "Numbers Station Research", date: "2025-07-17" }
    ]
  };

  function mdToHtml(md){
    md = md.replace(/[&<>]/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[s]));
    md = md.replace(/```([a-zA-Z0-9_-]+)?\n([\s\S]*?)```/g, (_m, lang, code) =>
      `<pre><code data-lang="${lang||''}">${code.replace(/</g,'&lt;')}</code></pre>`);
    md = md.replace(/^######\s+(.*)$/gm, '<h6>$1</h6>')
           .replace(/^#####\s+(.*)$/gm, '<h5>$1</h5>')
           .replace(/^####\s+(.*)$/gm, '<h4>$1</h4>')
           .replace(/^###\s+(.*)$/gm, '<h3>$1</h3>')
           .replace(/^##\s+(.*)$/gm, '<h2>$1</h2>')
           .replace(/^#\s+(.*)$/gm, '<h1>$1</h1>');
    md = md.replace(/^\s*[-*_]{3,}\s*$/gm, '<hr>');
    md = md.replace(/(^\d+\.\s+.*(?:\n(?:\d+\.\s+.*))*)/gm, match => {
      const items = match.split(/\n/).map(l => l.replace(/^\d+\.\s+/, '')).map(t=>`<li>${t}</li>`).join('');
      return `<ol>${items}</ol>`;
    });
    md = md.replace(/(^[-*+]\s+.*(?:\n(?:[-*+]\s+.*))*)/gm, match => {
      const items = match.split(/\n/).map(l => l.replace(/^[-*+]\s+/, '')).map(t=>`<li>${t}</li>`).join('');
      return `<ul>${items}</ul>`;
    });
    md = md.replace(/`([^`]+)`/g, '<code>$1</code>');
    md = md.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
           .replace(/\*([^*]+)\*/g, '<em>$1</em>');
    md = md.replace(/\[([^\]]+)\]\(([^)\s]+)(?:\s+")?(?:[^)"]*)?\)/g, '<a href="$2" target="_blank" rel="noopener">$1</a>');
    md = md.replace(/^(?!<h\d|<ul>|<ol>|<pre>|<hr>|\s*$)(.+)$/gm, '<p>$1</p>');
    return md;
  }

  function renderBlogList(){
    const box = document.getElementById('blogList'); if(!box) return;
    box.innerHTML = BLOG.index
      .sort((a,b)=> (a.date<b.date?1:-1))
      .map(p => `
        <div class="post-item">
          <div class="kicker">${p.date}</div>
          <h3 style="margin:.2rem 0 .2rem; font-size:16px; text-transform:uppercase; letter-spacing:.08em">
            <a href="#blog/post/${encodeURIComponent(p.file)}">${p.title}</a>
          </h3>
          <p class="muted">${BLOG.dir}/${p.file}</p>
        </div>
      `).join('');
  }

  async function loadPost(file){
    const art = document.getElementById('blogArticle'); if(!art) return;
    art.style.display = 'block'; art.innerHTML = '<div class="muted">Loading…</div>';
    try{
      const res = await fetch(`${BLOG.dir}/${file}`);
      if(!res.ok) throw new Error(`HTTP ${res.status}`);
      const md = await res.text();
      art.innerHTML = mdToHtml(md);
      art.scrollIntoView({behavior:'smooth', block:'start'});
    }catch(e){
      art.innerHTML = `<p class="muted">Could not load <code>${BLOG.dir}/${file}</code> — ${e.message}</p>`;
    }
  }

  function route(){
    const hash = decodeURIComponent(location.hash || '');
    const m = hash.match(/^#blog\/post\/(.+)$/);
    if(m){ loadPost(m[1]); }
  }

  window.addEventListener('hashchange', route);

  function init(){
    document.title = `${CONFIG.name} — Signals & Isotopes`;
    $('h1').textContent = CONFIG.name;
    $('#callsign').textContent = `${CONFIG.callsign} // ${CONFIG.name}`;
    $('#emailLink').href = `mailto:${CONFIG.email}`; $('#emailLink').textContent = CONFIG.email;
    $('#linkGithub').href = CONFIG.links.github; $('#linkMastodon').href = CONFIG.links.mastodon; $('#linkSubstack').href = CONFIG.links.substack;
    $('#year').textContent = new Date().getFullYear();
    drawNoise(); window.addEventListener('resize', drawNoise);
    startTicker(); updateUTC(); setInterval(updateUTC, 1000);
    renderPosts(); renderIsotopes();
    decayPlot();
    $('#spanHL').addEventListener('input', decayPlot);
    $('#n0').addEventListener('input', decayPlot);
    $('#simulateBtn').addEventListener('click', simulateDiscrete);
    $('#resetBtn').addEventListener('click', ()=>{ window._sim=[]; decayPlot(); });
    $('#rate').addEventListener('input', e=>{ geiger.rate = +e.target.value; $('#rateOut').textContent = geiger.rate; });
    $('#geigerStart').addEventListener('click', ()=>{ setupAudio(); geiger.on=true; geiger.next = geiger.ctx.currentTime; scheduleGeiger(); });
    $('#geigerStop').addEventListener('click', ()=>{ geiger.on=false; });
    $('#noiseToggle').addEventListener('click', toggleNoise);
    $('#encode').addEventListener('click', encodeMsg);
    $('#decode').addEventListener('click', decodeMsg);
    $('#copyGroups').addEventListener('click', ()=>copyText($('#groups')));
    $('#copyEmail').addEventListener('click', ()=>copyText(CONFIG.email));
    $('#openMail').addEventListener('click', ()=>{ location.href = `mailto:${CONFIG.email}`; });

    // Blog
    renderBlogList();
    route();
  }

  document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
